
<!DOCTYPE html>

<html lang="en">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=GTM-PSBN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'GTM-PSBN');
    </script>

    <meta charset="utf-8">
    <title>Talend Component Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="date" content="2018-02-13 17:49:41" scheme="YYYY-MM-dd HH:mm:ss">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="css/bootstrap.css" media="screen">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ink/3.1.0/css/font-awesome.min.css" integrity="sha256-MUe1D3T3ocGLZQ2h8wgpcIz5BoTu1OZo8q0BjK5u/o0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css" />
    <!--[if lt IE 9]>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.ie.min.css" />
    <![endif]-->
    <link rel="stylesheet" href="css/documentation.css">
    <link rel="shortcut icon" href="images/favicon_0.ico" />
    <style>
    body{padding-top:50px}body>.navbar{-webkit-transition:background-color .3s ease-in;transition:background-color .3s ease-in}@media (min-width:768px){body>.navbar-transparent{background-color:transparent}body>.navbar-transparent .navbar-nav>.open>a{background-color:transparent!important}}#home{padding-top:0}#home .navbar-brand{padding:13.5px 15px 12.5px}#home .navbar-brand>img{display:inline;margin:0 10px;height:100%}#banner{min-height:300px;border-bottom:none}.table-of-contents{margin-top:1em}.page-header h1{font-size:4em}.bs-docs-section{margin-top:6em}.bs-docs-section h1{padding-top:100px}.bs-component{position:relative}.bs-component .modal{position:relative;top:auto;right:auto;left:auto;bottom:auto;z-index:1;display:block}.bs-component .modal-dialog{width:90%}.bs-component .popover{position:relative;display:inline-block;width:220px;margin:20px}#source-button{position:absolute;top:0;right:0;z-index:100;font-weight:700}.progress{margin-bottom:10px}footer{margin:5em 0}footer li{float:left;margin-right:1.5em;margin-bottom:1.5em}footer p{clear:left;margin-bottom:0}.splash{padding:9em 0 2em;background-color:#141d27;background-image:url(../img/bg.jpg);background-size:cover;background-attachment:fixed;color:#fff;text-align:center}.splash .logo{width:160px}.splash h1{font-size:3em}.splash #social{margin:2em 0}.splash .alert{margin:2em 0}.section-tout{padding:4em 0 3em;border-bottom:1px solid rgba(0,0,0,.05);background-color:#eaf1f1}.section-tout .fa{margin-right:.5em}.section-tout p{margin-bottom:3em}.section-preview{padding:4em 0 4em}.section-preview .preview{margin-bottom:4em;background-color:#eaf1f1}.section-preview .preview .image{position:relative}.section-preview .preview .image:before{box-shadow:inset 0 0 0 1px rgba(0,0,0,.1);position:absolute;top:0;left:0;width:100%;height:100%;content:"";pointer-events:none}.section-preview .preview .options{padding:1em 2em 2em;border:1px solid rgba(0,0,0,.05);border-top:none;text-align:center}.section-preview .preview .options p{margin-bottom:2em}.section-preview .dropdown-menu{text-align:left}.section-preview .lead{margin-bottom:2em}@media (max-width:767px){.section-preview .image img{width:100%}}.sponsor #carbonads{max-width:240px;margin:0 auto}.sponsor .carbon-text{display:block;margin-top:1em;font-size:12px}.sponsor .carbon-poweredby{float:right;margin-top:1em;font-size:10px}@media (max-width:767px){.splash{padding-top:4em}.splash .logo{width:100px}.splash h1{font-size:2em}#banner{margin-bottom:2em;text-align:center}}
    </style>
  </head>
  <body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSBN"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <a class="github-fork-ribbon" target="_blank"
        href="https://github.com/talend/component-runtime" data-ribbon="Fork me on GitHub"
        title="Fork me on GitHub">Fork me on GitHub</a>
    <div class="col-sm-offset-1 col-sm-10">

	
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <a href="/component-runtime/index.html" class="navbar-brand">Component Kit</a>
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse" id="navbar-main">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="entries">Documentation <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="entries">
            <li><a href="/component-runtime/index.html">Home</a></li>
            <li><a href="documentation-overview.html">Overview</a></li>
            <li><a href="getting-started.html">Getting Started</a></li>
            <li><a href="documentation.html">Reference</a></li>
            <li><a href="best-practices.html">Best Practices</a></li>
            <li><a href="documentation-testing.html">Testing</a></li>
            <li><a href="documentation-rest.html">REST API</a></li>
            <li><a href="wrapping-a-beam-io.html">How to wrap a Beam I/O</a></li>
            <li><a href="studio.html">Studio Integration</a></li>
            <li><a href="changelog.html">Changelog</a></li>
            <li><a href="contributors.html">Wall of Fame</a></li>
            <li><a href="apidocs.html">API Documentation</a></li>
            <li><a href="appendix.html">Appendix</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="versions">Versions <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="versions">
            <li><a href="/component-runtime/index.html">Current</a></li>
            <li><a href="/component-runtime/latest/index.html">Latest</a></li>
            
          </ul>
        </li>
      </ul>
      <div class="navbar-collapse collapse">
        <form class="navbar-form navbar-right" role="search" action="search.html">
          <div class="form-group">
            <input type="text" class="form-control" placeholder="Search" name="q">
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


    <div class="container section-padded">
        <div class="row title">
            <div class='page-header'>
              <h2>Services</h2>
            </div>
        </div>
        <div class="row">
            
            <div class="col-md-12">
                <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_internationalization">1. Internationalization</a>
<ul class="sectlevel2">
<li><a href="#_internationalization_api">1.1. Internationalization API</a></li>
</ul>
</li>
<li><a href="#_providing_some_actions_for_consumers_clients">2. Providing some actions for consumers/clients</a>
<ul class="sectlevel2">
<li><a href="#_particular_action_types">2.1. Particular action types</a></li>
</ul>
</li>
<li><a href="#_built_in_services">3. Built in services</a>
<ul class="sectlevel2">
<li><a href="#_httpclient_usage">3.1. HttpClient usage</a></li>
</ul>
</li>
<li><a href="#_services_and_interceptors">4. Services and interceptors</a></li>
<li><a href="#_creating_an_execution_chain_or_pipeline">5. Creating an execution chain or pipeline</a>
<ul class="sectlevel2">
<li><a href="#_standalone_chains">5.1. Standalone chains</a></li>
<li><a href="#_beam_case">5.2. Beam case</a></li>
</ul>
</li>
<li><a href="#_advanced_define_a_custom_api">6. Advanced: define a custom API</a>
<ul class="sectlevel2">
<li><a href="#_extending_the_ui">6.1. Extending the UI</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_internationalization">1. Internationalization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Recommanded practise for internationalization are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>store messages using <code>ResourceBundle</code> properties file in your component module</p>
</li>
<li>
<p>the location of the properties are in the same package than the related component(s) and is named <code>Messages</code> (ex: <code>org.talend.demo.MyComponent</code> will use <code>org.talend.demo.Messages[locale].properties</code>)</p>
</li>
<li>
<p>for your own messages use the internationalization API</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_internationalization_api">1.1. Internationalization API</h3>
<div class="paragraph">
<p>Overal idea is to design its messages as methods returning <code>String</code> values
and back the template by a <code>ResourceBundle</code> located in the same package than the interface
defining these methods and named <code>Messages</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
this is the mecanism to use to internationalize your own messages in your own components.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To ensure you internationalization API is identified you need to mark it with <code>@Internationalized</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Internationalized</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Translator</span> {

    <span style="color:#0a8;font-weight:bold">String</span> message();

    <span style="color:#0a8;font-weight:bold">String</span> templatizedMessage(<span style="color:#0a8;font-weight:bold">String</span> arg0, <span style="color:#339;font-weight:bold">int</span> arg1); <i class="conum" data-value="2"></i><b>(2)</b>

    <span style="color:#0a8;font-weight:bold">String</span> localized(<span style="color:#0a8;font-weight:bold">String</span> arg0, <span style="color:#007">@Language</span> <span style="color:#0a8;font-weight:bold">Locale</span> locale); <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Internationalized</code> allows to mark a class as a i18n service</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>you can pass parameters and the message will use <code>MessageFormat</code> syntax to be resolved based on the <code>ResourceBundle</code> template</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>you can use <code>@Language</code> on a <code>Locale</code> parameter to specify manually the locale to use, note that a single value will be used (the first parameter tagged as such).</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_providing_some_actions_for_consumers_clients">2. Providing some actions for consumers/clients</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In some cases you will desire to add some actions unrelated to the runtime. A simple example
is to enable clients - the users of the plugin/library - to test if a connection works. Even more concretely: <em>does my database is up?</em>.</p>
</div>
<div class="paragraph">
<p>To do so you need to define an <code>@Action</code> which is a method with a name (representing the event name) in a class decorated with <code>@Service</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyDbTester</span> {
    <span style="color:#007">@Action</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mycomp</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> Status doTest(<span style="color:#088;font-weight:bold">final</span> IncomingData data) {
        <span style="color:#080;font-weight:bold">return</span> ...;
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
services are singleton so if you need some thread safety ensure they match that requirement. They
shouldn&#8217;t store any state too (state is held by the component) since they can be serialized any time.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
services are usable in components as well (matched by type) and allow to reuse some shared logic like a client. Here is a sample
with a service used to access files:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Emitter</span>(family = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PersonReader</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Serializable</span> {
    <span style="color:#777">// attributes skipped to be concise</span>

    <span style="color:#088;font-weight:bold">public</span> PersonReader(<span style="color:#007">@Option</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>) <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">File</span> file,
                        <span style="color:#088;font-weight:bold">final</span> FileService service) {
        <span style="color:#950">this</span>.file = file;
        <span style="color:#950">this</span>.service = service;
    }

    <span style="color:#777">// use the service</span>
    <span style="color:#007">@PostConstruct</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> open() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">FileNotFoundException</span> {
        reader = service.createInput(file);
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
service is passed to constructor automatically, it can be used as a bean. Only call of service&#8217;s method is required.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_particular_action_types">2.1. Particular action types</h3>
<div class="paragraph">
<p>Some actions are that common and need a clear contract so they are defined as API first citizen, this is the case for wizards or healthchecks
for instance. Here is the list of all actions:</p>
</div>
<table class="tableblock frame-all grid-all table-striped table-hover table-ordered">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Return type</th>
<th class="tableblock halign-left valign-top">Sample returned type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.completion.DynamicValues</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dynamic_values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a method as being useful to fill potential values of a string option for a property denoted by its value. You can link a field as being completable using @Proposable(value). The resolution of the completion action is then done through the component family and value of the action. The callback doesn&#8217;t take any parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"items":[{"id":"value","label":"label"}]}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.healthcheck.HealthCheck</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">healthcheck</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This class marks an action doing a connection test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HealthCheckStatus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"comment":"Something went wrong","status":"KO"}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.schema.DiscoverSchema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark an action as returning a discovered schema. Its parameter MUST be the type decorated with <code>@Discoverable</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"entries":[{"name":"column1","type":"STRING"}]}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.Action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@org.talend.sdk.component.api.service.asyncvalidation.AsyncValidation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mark a method as being used to validate a configuration. IMPORTANT: this is a server validation so only use it if you can&#8217;t use other client side validation to implement it.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ValidationResult</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{"comment":"Something went wrong","status":"KO"}</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_built_in_services">3. Built in services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The framework provides some built-in services you can inject by type in components and actions out of the box.</p>
</div>
<div class="paragraph">
<p>Here is the list:</p>
</div>
<table class="tableblock frame-all grid-all">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>org.talend.sdk.component.api.service.cache.LocalCache</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a small abstraction to cache data which don&#8217;t need to be recomputed very often. Commonly used by actions for the UI interactions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>org.talend.sdk.component.api.service.dependency.Resolver</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Allows to resolve a dependency from its Maven coordinates.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>javax.json.spi.JsonProvider</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A JSON-P instance. Prefer other JSON-P instances if you don&#8217;t exactly know why you use this one.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>javax.json.JsonBuilderFactory</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A JSON-P instance. It is recommanded to use this one instead of a custom one for memory/speed optimizations.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>javax.json.JsonWriterFactory</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A JSON-P instance. It is recommanded to use this one instead of a custom one for memory/speed optimizations.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>javax.json.JsonReaderFactory</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A JSON-P instance. It is recommanded to use this one instead of a custom one for memory/speed optimizations.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>javax.json.stream.JsonParserFactory</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A JSON-P instance. It is recommanded to use this one instead of a custom one for memory/speed optimizations.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>javax.json.stream.JsonGeneratorFactory</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A JSON-P instance. It is recommanded to use this one instead of a custom one for memory/speed optimizations.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
it assumes the dependency is locally available to the execution instance which is not guaranteed yet by the framework.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>org.talend.sdk.component.api.service.configuration.LocalConfiguration</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Represents the local configuration which can be used during the design.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
it is not recommanded to use it for the runtime since the local configuration is generally different and the instances are distincts.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
you can also use the local cache as an interceptor with <code>@Cached</code>
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Every interface that extends <code>HttpClient</code> and that contains methods annotated with <code>@Request</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This let you define an http client in a declarative manner using an annotated interface.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="#_httpclient_usage">HttpClient usage</a> for details.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_httpclient_usage">3.1. HttpClient usage</h3>
<div class="paragraph">
<p>Let assume that we have a REST API defined like below, and that it requires a basic authentication header.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET     <code>/api/records/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST    <code>/api/records</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">with a json playload to be created <code>{"id":"some id", "data":"some data"}</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To create an http client able to consume this REST API, we will define an interface that extends <code>HttpClient</code>,</p>
</div>
<div class="paragraph">
<p>The <code>HttpClient</code> interface lets you set the <code>base</code> for the http address that our client will hit.</p>
</div>
<div class="paragraph">
<p>The <code>base</code> is the part of the address that we will need to add to the request path to hit the api.</p>
</div>
<div class="paragraph">
<p>Every method annotated with <code>@Request</code> of our interface will define an http request.
Also every request can have <code>@Codec</code> that let us encode/decode the request/response playloads.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
if your payload(s) is(are) <code>String</code> or <code>Void</code> you can ignore the coder/decoder.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">APIClient</span> <span style="color:#088;font-weight:bold">extends</span> HttpClient {
    <span style="color:#007">@Request</span>(path = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">api/records/{id}</span><span style="color:#710">&quot;</span></span>, method = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">GET</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#007">@Codec</span>(decoder = RecordDecoder.class) <span style="color:#777">//decoder =  decode returned data to Record class</span>
    Record getRecord(<span style="color:#007">@Header</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Authorization</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> basicAuth, <span style="color:#007">@Path</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">id</span><span style="color:#710">&quot;</span></span>) <span style="color:#339;font-weight:bold">int</span> id);

    <span style="color:#007">@Request</span>(path = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">api/records</span><span style="color:#710">&quot;</span></span>, method = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">POST</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#007">@Codec</span>(encoder = RecordEncoder.class, decoder = RecordDecoder.class) <span style="color:#777">//encoder = encode record to fit request format (json in this example)</span>
    Record createRecord(<span style="color:#007">@Header</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Authorization</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> basicAuth, Record record);
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The interface should extends <code>HttpClient</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the codec classes (class that implement Encoder/Decoder) you can inject any of your services annotated with <code>@Service</code> or <code>@Internationalized</code> into the constructor.
The i18n services can be useful to have i18n messages for errors handling for example.</p>
</div>
<div class="paragraph">
<p>This interface can be injected into our Components classes or Services to consume the defined api.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyService</span> {

    <span style="color:#088;font-weight:bold">private</span> APIClient client;

    <span style="color:#088;font-weight:bold">public</span> MyService(...,APIClient client){
        <span style="color:#777">//...</span>
        <span style="color:#950">this</span>.client = client;
        client.base(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://localhost:8080</span><span style="color:#710">&quot;</span></span>);<span style="color:#777">// init the base of the api, ofen in a PostConstruct or init method</span>
    }

    <span style="color:#777">//...</span>
    <span style="color:#777">// Our get request</span>
    Record rec =  client.getRecord(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Basic MLFKG?VKFJ</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">100</span>);

    <span style="color:#777">//...</span>
    <span style="color:#777">// Our post request</span>
    Record newRecord = client.createRecord(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Basic MLFKG?VKFJ</span><span style="color:#710">&quot;</span></span>, <span style="color:#080;font-weight:bold">new</span> Record());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: by default <code><strong>/</strong>+json</code> are mapped to JSON-P and <code><strong>/</strong>+xml</code> to JAX-B if the model has a <code>@XmlRootElement</code> annotation.</p>
</div>
<div class="sect3">
<h4 id="_advanced_http_client_request_customization">3.1.1. Advanced HTTP client request customization</h4>
<div class="paragraph">
<p>For advanced cases you can customize the <code>Connection</code> directly using <code>@UseConfigurer</code> on the method.
It will call your custom instance of <code>Configurer</code>. Note that you can use some <code>@ConfigurerOption</code> in the method
signature to pass some configurer configuration.</p>
</div>
<div class="paragraph">
<p>For instance if you have this configurer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BasicConfigurer</span> <span style="color:#088;font-weight:bold">implements</span> Configurer {
    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> configure(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Connection</span> connection, <span style="color:#088;font-weight:bold">final</span> ConfigurerConfiguration configuration) {
        <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> user = configuration.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">username</span><span style="color:#710">&quot;</span></span>, <span style="color:#0a8;font-weight:bold">String</span>.class);
        <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> pwd = configuration.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span>, <span style="color:#0a8;font-weight:bold">String</span>.class);
        connection.withHeader(
            <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Authorization</span><span style="color:#710">&quot;</span></span>,
            Base64.getEncoder().encodeToString((user + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">:</span><span style="color:#710">'</span></span> + pwd).getBytes(StandardCharsets.UTF_8)));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then set it on a method to automatically add the basic header with this kind of API usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">APIClient</span> <span style="color:#088;font-weight:bold">extends</span> HttpClient {
    <span style="color:#007">@Request</span>(path = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#007">@UseConfigurer</span>(BasicConfigurer.class)
    Record findRecord(<span style="color:#007">@ConfigurerOption</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">username</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> user, <span style="color:#007">@ConfigurerOption</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> pwd);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_services_and_interceptors">4. Services and interceptors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For common concerns like caching, auditing etc, it can be fancy to use interceptor like API. It is enabled by the framework
on services.</p>
</div>
<div class="paragraph">
<p>An interceptor defines an annotation marked with <code>@Intercepts</code> which defines the implementation of the interceptor (an <code>InterceptorHandler</code>).</p>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Intercepts</span>(LoggingHandler.class)
<span style="color:#007">@Target</span>({ TYPE, METHOD })
<span style="color:#007">@Retention</span>(RUNTIME)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Logged {
    <span style="color:#0a8;font-weight:bold">String</span> value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then handler is created from its constructor and can take service injections (by type). The first parameter, however, can be
a <code>BiFunction&lt;Method, Object[], Object&gt;</code> which representes the invocation chain if your interceptor can be used with others.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
if you do a generic interceptor it is important to pass the invoker as first parameter. If you don&#8217;t do so
you can&#8217;t combine interceptors at all.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is an interceptor implementation for our <code>@Logged</code> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">LoggingHandler</span> <span style="color:#088;font-weight:bold">implements</span> InterceptorHandler {
    <span style="color:#777">// injected</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> BiFunction&lt;<span style="color:#0a8;font-weight:bold">Method</span>, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span>, <span style="color:#0a8;font-weight:bold">Object</span>&gt; invoker;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> SomeService service;

    <span style="color:#777">// internal</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">ConcurrentMap</span>&lt;<span style="color:#0a8;font-weight:bold">Method</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt; loggerNames = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ConcurrentHashMap</span>&lt;&gt;();

    <span style="color:#088;font-weight:bold">public</span> CacheHandler(<span style="color:#088;font-weight:bold">final</span> BiFunction&lt;<span style="color:#0a8;font-weight:bold">Method</span>, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span>, <span style="color:#0a8;font-weight:bold">Object</span>&gt; invoker, <span style="color:#088;font-weight:bold">final</span> SomeService service) {
        <span style="color:#950">this</span>.invoker = invoker;
        <span style="color:#950">this</span>.service = service;
    }

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> invoke(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Method</span> method, <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> name = loggerNames.computeIfAbsent(method, m -&gt; findAnnotation(m, Logged.class).get().value());
        service.getLogger(name).info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Invoking {}</span><span style="color:#710">&quot;</span></span>, method.getName());
        <span style="color:#080;font-weight:bold">return</span> invoker.apply(method, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This implementation is compatible with interceptor chains since it takes the invoker as first constructor parameter
and it also takes a service injection. Then the implementation just does what is needed - logging the invoked method here.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the <code>findAnnotation</code> annotation - inherited from <code>InterceptorHandler</code> is an utility method to find an annotation on a method
or class (in this order).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_an_execution_chain_or_pipeline">5. Creating an execution chain or pipeline</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are two kind of chains the framework supports:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>standalone chains</p>
</li>
<li>
<p><a href="https://beam.apache.org/">Beam</a> chains</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_standalone_chains">5.1. Standalone chains</h3>
<div class="paragraph">
<p>For now the standalone chains only support linear flows (more to come) and are built based on a <code>ExecutionChainBuilder</code>.</p>
</div>
<div class="paragraph">
<p>This one will take some metadata about the flow (which input with which configuration, which processors, which processor order and configuration&#8230;&#8203;)
and will execute it linearly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExecutionChainBuilder.start()
        .withConfiguration(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SampleJob</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">true</span>) <i class="conum" data-value="1"></i><b>(1)</b>
        .withInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{ <i class="conum" data-value="2"></i><b>(2)</b>
            put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/input.csv</span><span style="color:#710">&quot;</span></span>);
        }})
        .toProcessor(<span style="color:#069">null</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">2</span>, emptyMap()) <i class="conum" data-value="2"></i><b>(2)</b>
        .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reject</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{ <i class="conum" data-value="2"></i><b>(2)</b>
            put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/output.csv</span><span style="color:#710">&quot;</span></span>);
        }}).getParent()
        .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reject</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{ <i class="conum" data-value="2"></i><b>(2)</b>
            put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/output.csv</span><span style="color:#710">&quot;</span></span>);
        }})
        .create(manager, plugin -&gt; <span style="color:#069">null</span>, <span style="color:#080;font-weight:bold">new</span> CountingSuccessListener(), <span style="color:#080;font-weight:bold">new</span> ToleratingErrorHandler(<span style="color:#00D">0</span>)) <i class="conum" data-value="3"></i><b>(3)</b>
        .get()
        .execute(); <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can configure some global execution configuration, like giving it a name and if system properties can override the component configuration
using <code>&lt;component group name&gt;.&lt;component name&gt;.&lt;configuration property name&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Each component is registered from its component name (what is passed in <code>family</code> of the component annotation),
its own name (<code>name</code> method of the annotation) and its configuration as a map (2).</p>
</div>
<div class="paragraph">
<p>Once the flow is defined (there is no more processor after), then you can create the <code>ExecutionChain</code> (3) with its success/error listeners
to handle it in a custom manner and finally you can get it and execute the flow/pipeline (4).</p>
</div>
<div class="paragraph">
<p>A chain needs a <code>ComponentManager</code> which is the manager of the plugins. The easiest is to use its default constructor to create one instance.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
this manager needs to be closed when no more needed so don&#8217;t forget to call close.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here is a sample code for the previous chain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#088;font-weight:bold">final</span> ComponentManager manager = ComponentManager.instance()
        ExecutionChainBuilder.start()
                .withConfiguration(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SampleJob</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">true</span>)
                .fromInput(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/input.csv</span><span style="color:#710">&quot;</span></span>);
                }})
                .toProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">rejected</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, emptyMap())
                .getParent()
                .toProcessor(Branches.DEFAULT_BRANCH, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, emptyMap())
                .toProcessor(Branches.DEFAULT_BRANCH, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">3</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/tmp/output.csv</span><span style="color:#710">&quot;</span></span>);
                }})
                .create(manager, plugin -&gt; <span style="color:#069">null</span>, <span style="color:#080;font-weight:bold">new</span> CountingSuccessListener(), <span style="color:#080;font-weight:bold">new</span> ToleratingErrorHandler(<span style="color:#00D">0</span>))
                .get()
                .execute();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
this API is not very powerful but allows to test simple cases, you can have a look to beam direct runner and the Talend Component beam bridge
for more advanced cases.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
the number before the configuration (map) is the version of this configuration, it allows to automatically migrate
from a version to the currently available one when needed.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_string_based_dsl">5.1.1. String based DSL</h4>
<div class="paragraph">
<p><code>ExecutionChainDsl</code> exposes a way to define pipeline based on URI instead of previous syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">from(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">chain://list?__version=1&amp;values[0]=a&amp;values[1]=bb&amp;values[2]=ccc</span><span style="color:#710">&quot;</span></span>)
    .to(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">chain://count?__version=1</span><span style="color:#710">&quot;</span></span>)
    .to(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">chain://file?__version=1&amp;file=</span><span style="color:#710">&quot;</span></span> + output.getAbsolutePath())
    .create()
    .execute();</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
query parameters must be URI/URL encoded.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_beam_case">5.2. Beam case</h3>
<div class="paragraph">
<p>For beam case, you need to rely on beam pipeline definition and use <code>component-runtime-beam</code> dependency which provides Beam bridges.</p>
</div>
<div class="sect3">
<h4 id="_i_o">5.2.1. I/O</h4>
<div class="paragraph">
<p><code>org.talend.sdk.component.runtime.beam.TalendIO</code> provides a way to convert a partition mapper or a processor to an input or processor
using the <code>read</code> or <code>write</code> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#088;font-weight:bold">final</span> ComponentManager manager = ComponentManager.instance()
        Pipeline pipeline = Pipeline.create();
        <span style="color:#777">//Create beam input from mapper and apply input to pipeline</span>
        pipeline.apply(TalendIO.read(manager.findMapper(manager.findMapper(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reader</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fileprefix</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">input</span><span style="color:#710">&quot;</span></span>);
                }}).get()))
                .apply(<span style="color:#080;font-weight:bold">new</span> ViewsMappingTransform(emptyMap(), <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>)) <span style="color:#777">// prepare it for the output record format (see next part)</span>
        <span style="color:#777">//Create beam processor from talend processor and apply to pipeline</span>
                .apply(TalendIO.write(manager.findProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">test</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">writer</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">String</span>&gt;() {{
                    put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fileprefix</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">output</span><span style="color:#710">&quot;</span></span>);
                }}).get(), emptyMap()));

        <span style="color:#777">//... run pipeline</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_processors">5.2.2. Processors</h4>
<div class="paragraph">
<p><code>org.talend.sdk.component.runtime.beam.TalendFn</code> provides the way to wrap a processor in a Beam <code>PTransform</code> and integrate it in the pipeline.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#777">//Component manager and pipeline initialization...</span>

        <span style="color:#777">//Create beam PTransform from processor and apply input to pipeline</span>
        pipeline.apply(TalendFn.asFn(manager.findProcessor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mapper</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>, emptyMap())).get())), emptyMap());

        <span style="color:#777">//... run pipeline</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The multiple inputs/outputs are represented by a <code>Map</code> element in beam case to avoid to use multiple inputs/outputs.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
you can use <code>ViewsMappingTransform</code> or <code>CoGroupByKeyResultMappingTransform</code> to adapt the input/output
format to the record format representing the multiple inputs/output, so a kind of <code>Map&lt;String, List&lt;?&gt;&gt;</code>,
but materialized as a <code>JsonObject</code>. Input data must be of type <code>JsonObject</code> in this case.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_deployment">5.2.3. Deployment</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Beam serializing components it is crucial to add <code>component-runtime-standalone</code> dependency to the project. It will take
care of providing an implicit and lazy <code>ComponentManager</code> managing the component in a fatjar case.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_convert_a_beam_io_in_a_component_i_o">5.2.4. Convert a Beam.io in a component I/O</h4>
<div class="paragraph">
<p>For simple I/O you can get automatic conversion of the Beam.io to a component I/O transparently if you decorated your <code>PTransform</code>
with <code>@PartitionMapper</code> or <code>@Processor</code>.</p>
</div>
<div class="paragraph">
<p>The limitation are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inputs must implement <code>PTransform&lt;PBegin, PCollection&lt;?&gt;&gt;</code> and must be a <code>BoundedSource</code>.</p>
</li>
<li>
<p>Outputs must implement <code>PTransform&lt;PCollection&lt;?&gt;, PDone&gt;</code> and just register on the input <code>PCollection</code> a <code>DoFn</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information on that topic on <a href="wrapping-a-beam-io.html">How to wrap a Beam I/O</a> page.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_define_a_custom_api">6. Advanced: define a custom API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to extend the Component API for custom front features.</p>
</div>
<div class="paragraph">
<p>What is important here is to keep in mind you should do it
only if it targets not portable components (only used by the Studio or Beam).</p>
</div>
<div class="paragraph">
<p>In term of organization it is recommanded to create a custom <code>xxxx-component-api</code> module with the new set of annotations.</p>
</div>
<div class="sect2">
<h3 id="_extending_the_ui">6.1. Extending the UI</h3>
<div class="paragraph">
<p>To extend the UI just add an annotation which can be put on <code>@Option</code> fields which is decorated with <code>@Ui</code>.
All its members will be put in the metadata of the parameter. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Ui</span>
<span style="color:#007">@Target</span>(TYPE)
<span style="color:#007">@Retention</span>(RUNTIME)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> MyLayout {
}</code></pre>
</div>
</div>
</div>
</div>
</div>
            </div>
            
        </div>
    </div>


    <footer>
        <div class="row">
          <div class="col-lg-12">

            <ul class="list-unstyled">
              <li class="pull-right"><a href="#top">Back to top</a></li>
            </ul>
          </div>
        </div>
    </footer>
    </div>

    <script src="js/jquery-1.10.2.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap.js"></script>
  </body>
</html>

